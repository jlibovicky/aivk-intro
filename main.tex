\documentclass[aspectratio=169,dvipsnames]{beamer}

%\usepackage[czech]{babel}
\usepackage{polyglossia}
\setmainlanguage{czech}
\usepackage[nounicodemath,czech]{ufalslides}
\usepackage{xcolor}
\usepackage{textcomp}
\usepackage{booktabs}
\usepackage{collcell}
\usepackage{xstring}
\usepackage{tikz-dependency}
\usepackage{amssymb}

%\usepackage{csquotes}
%\usepackage[citestyle=authoryear]{biblatex}


%\makeatletter
%\def\blx@nowarnpolyglossia{1}
%\makeatother

\usepackage{tikz}
\usepackage{gnuplot-lua-tikz}
\usepackage{tikz-qtree}
\usetikzlibrary{calc}
\usetikzlibrary{arrows,shapes,positioning}
\usetikzlibrary{arrows.meta}

\setbeamercolor{blockcolor}{bg=gray!20, fg=black}


% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\course{NAIL127 AI v Kontextu}
\def\courseurl{https://ufal.mff.cuni.cz/AIvK}
\def\title{Úvodní přednáška}
\def\subtitle{Co je a není AI, co je strojové učení a neuronové sítě}
\def\author{Jindřich Libovický, Tereza Hanemann, Rudolf Rosa}
\def\date{14. února 2022}
\def\licence{cc-by-nc-sa}
%\def\langtech{}
\def\shownavigation{}
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\maketitle

\section{AI v Kontextu}

\begin{frame}{Tým AI v kontextu}

    \begin{columns}
        \column{30pt}
    \begin{tikzpicture}
    \clip (0,0) circle (30pt);
    \node at (0.0,-0.15) {\includegraphics[scale=0.3]{img/tereza.jpg}};
    \end{tikzpicture}
        \column{.6\textwidth}
        \textbf{Tereza Hanemann}

    \end{columns}

    \hspace*{20pt}\begin{columns}
        \column{30pt}
    \begin{tikzpicture}
    \clip (0,0) circle (30pt);
    \node at (0.0,-0.7) {\includegraphics[scale=0.35]{img/rudolfrosa.png}};
    \end{tikzpicture}
        \column{.6\textwidth}
        \textbf{Rudolf Rosa}

    \end{columns}

    \hspace*{40pt}\begin{columns}
        \column{30pt}
    \begin{tikzpicture}
    \clip (0,0) circle (30pt);
    \node at (0.0,-0.3) {\includegraphics[scale=0.35]{img/jindrich.jpg}};
    \end{tikzpicture}
        \column{.6\textwidth}
        \textbf{Jindřich Libovický}

    \end{columns}

\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Organizace předmětu}
\end{frame}
% ----------------------------------------------------------------------------

\begin{frame}{Program}
\end{frame}

\section{Co je umělá inteligence}

% ----------------------------------------------------------------------------

\begin{frame}{Ne-definice}

    \begin{center}
        \Large
    \textbf{Umělá inteligence} = obor informatiky, který se zabývá řešením
    úloh\ldots
    \end{center}

    \vspace{10pt}

    \begin{itemize}

        \item<2-> O kterých se vágně shodneme, že k~jejich řešení lidé potřebují
            inteligenci

        \item<3-> Někdy úlohy, které vyžadují \textbf{velké mentální úsilí} \\
            \quad \emph{hraní šachů nebo Go, automatický překlad}

        \item<4-> Někdy úlohy, které jsou \textbf{pro člověka triviální} \\
            \quad \emph{rozpoznávání objektů na fotografii, rozpozávání řeči}

    \end{itemize}

    \centering\vspace{15pt}

    \visible<5->{Hranice, co je a není AI, se posouvá\ldots}

\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Inteligentní chování = AI?}

    \begin{columns}
        \column{.40\textwidth}
        \includegraphics[scale=0.45]{./img/navigation.pdf}

        \column{.55\textwidth}

        \begin{enumerate}

            \item<2-> Rozpoznávání řeči \\
                \visible<9->{\hfill\it\color{gray} neuronová síť naučená z nahrávek}

            \item<3-> Analýza textu \\
                \visible<10->{\hfill\it\color{gray} pravidla nebo neuronová síť}

            \item<4-> Vyhledání cíle na mapě \\
                \visible<11->{\hfill\it\color{gray} vyhledávání v databázi, spíš SW inženýrství}

            \item<5-> Nalezení nejlepší cesty \\
                \visible<12->{\hfill\it\color{gray} optimalizace, diskrétní matematika}

            \item<6-> Určení polohy, rozhodnutí co je další krok na nejlepší cestě
                \visible<13->{\hfill\it\color{gray} jednoduchý algoritmus}

            \item<7-> Generování přirozeného jazyka \\
                \visible<14->{\hfill\it\color{gray} jednoduchý algoritmus nebo neuronová síť}

            \item<8-> Syntéza řeči \\
                \visible<15->{\hfill\it\color{gray} neuronová síť naučená z nahrávek}

        \end{enumerate}

    \end{columns}

\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Strong vs. Weak AI}

    \begin{columns}[t]
        \column{.45\textwidth}
        \begin{center}
        \visible<1->{{\Large \textbf{Strong AI}}}
        \end{center}

        \vspace{5pt}

        \begin{itemize}

            \item<2-> Také AGI -- Artifitial General Inteligence

            \item<3-> Cílem je obecně \textbf{inteligentní stroj}, který v důsledku
                toho umí řešit úlohy

            \item<4-> Zajímavé filozofické problémy: Inteligenční singularita?
                Musela by být AGI vtělená?

        \end{itemize}


        \column{.45\textwidth}
        \begin{center}
        \visible<5->{{\Large \textbf{Weak AI}}}
        \end{center}

        \vspace{5pt}

        \begin{itemize}

            \item<6-> Také Narrow AI

            \item<7-> Cílem je řešit \textbf{jednotlivé úlohy}, které vyžadují
                inteligenci

            \item<8-> Všechno, o čem bude řeč, je weak AI

        \end{itemize}
    \end{columns}


\end{frame}

% ----------------------------------------------------------------------------

%\begin{frame}{Strong AI: Turingův test}
%
%\end{frame}
%
%% ----------------------------------------------------------------------------
%
%\begin{frame}{Strong AI: Čínský pokoj}
%
%\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Když se dneska řekne AI}

    \Large

    \begin{itemize}

        \item Myslí se \textbf{weak AI}

        \item Většinou jsou to metody založené na \textbf{strojovém učení} a zpracování
            \textbf{hodně dat}

        \item Často je to strojové učení pomocí \textbf{neuronových sítí}

    \end{itemize}


\end{frame}


% ----------------------------------------------------------------------------

\section{Strojové učení \& Neuronové sítě}

\begin{frame}{Běžné programování vs.\ strojové učení}

    {\large \textbf{Programování řešení}}

    \begin{itemize}

        \item<2-> Jsme schopni problém \textbf{formálně popsat} jasnými koncepty

        \item<3-> Program je jednoznačný návod, jak s koncepty zacházet

    \end{itemize}

    \vspace{10pt}

    \visible<4->{%
    \begin{beamercolorbox}{blockcolor}
    {\color{ufal} Příklad -- E-shop:} {\it Koncepty: zboží, sklad, zákazník,
    objednávka} \\
    \quad Udělat obědnávku, odeslat obědnávku = jednoduchý algoritmus
    \end{beamercolorbox}}

    \vspace{20pt}

    \visible<5->{{\large \textbf{Učení řešení}}}

    \begin{itemize}

        \item<6-> Máme \textbf{příklady} vstupů a výstupů

        \item<7-> Nejsme schopni do důsledku napsat návod, jak úlohu řešit

    \end{itemize}

    \vspace{10pt}

    \visible<7->{%
    \begin{beamercolorbox}[]{blockcolor}
    {\color{ufal} Příklad -- strojový překlad:} {\it neexstiuje návod, pro člověka, který nerozumím oběma jazykům} \\
    \quad Existuje mnoho přeložených textů, co se dají použít pro trénování
    \end{beamercolorbox}}

\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Obecné schéma}

    \centering
\scalebox{.8}{%
\begin{tikzpicture}%
[   normal arrow/.style={draw,-triangle 45,very thick},
    big box/.style={draw=####1!20!black, fill=####1!60, minimum width=9em, minimum height=9em, rectangle, align=center},
    small box/.style={draw, minimum height=5mm, minimum width=####1, rectangle}
]
\node[big box = RoyalBlue] (d) at (1, -5) {};
\node[above] at (d.north) {};
\node[below, align=center] at (d.north) {data};
\node[big box = ForestGreen] (a) at (7, -5) {};
\node[below, align=center] at (a.north) {učící algoritmus};
\node[big box = Dandelion] (m) at (14, -5) {};
\node[below, align=center] at (m.north) {model};

\path[normal arrow] (d) -- (a);
\path[normal arrow] (a) -- (m);

\foreach \x in {1,...,3} {%
	\node[small box = 5em] (x\x) at (0.4, -3.4 - \x * 0.8) {$x_{\x}$};
	\node[small box = 1.5em] (y\x) at (2.2, -3.4 - \x * 0.8) {$y_{\x}$};
	\path[draw] (x\x) -- (y\x);
}
\node[] (xc) at (0.4, -3.2 - 4 * 0.8) {$\vdots$};
\node[] (yc) at (2.2, -3.2 - 4 * 0.8) {$\vdots$};

\node[small box = 5em] (x) at (14, -2) {$x$};
\node[small box = 1.5em] (y) at (14, -8) {$y$};

\path[normal arrow] (x) -- (m);
\path[normal arrow] (m) -- (y);

\node[] (p) at (7, -1.5) {předpoklady};
\node[] (po) at (7, -8.5) {požadavky};

\path[draw, triangle 45-triangle 45, dashed] (d) -- (p);
\path[normal arrow] (p) -- (a);
\path[draw, triangle 45-triangle 45, dashed] (po) -- (m);
\path[normal arrow] (po) -- (a);

\node[small box = 6em] (meta) at (7, -5) {metaparametry};

\node[small box = 6em] (par-alg) at (14, -5) {parametery};
\node[small box = 6em] (par) at (14, -6) {algorithmus};

\end{tikzpicture}}

    \vspace{1em}

    \visible<2->{Chceme model, co \textbf{generelalizuje} pro nová data.}

\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Příklad strojového učení}

    \centering
    \begin{tabular}{lcc}
        & \visible<1->{\bf Rozpoznávání objektů & \bf Strojový překlad} \\ \midrule

        \visible<2->{
        \bf Data & $x$: RGB obrázek           & $x$: Věta ve zrodojovém jazyce \\
             & $y$: Pozice a typ objektu  & $y$: Věta v cílovém jazyce \\ \midrule}

         \visible<3->{
        \bf Učící algoritmus & \multicolumn{2}{c}{Minimalizace chyby, gradient descent} \\ \midrule}

    \visible<4->{
        \bf Model & konvoluční neuronová síť & Transformer (neuronová síť)  \\ \midrule}

    \visible<5->{
    \bf Algoritmus & sliding window přes obrázek & autoregresivní dekódování \\
               & (obdélníky různých velikostí) & (vždy jedno slov na výstup, \\
               &  & jde na vstup v dalším kroku)}

    \end{tabular}


\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Generalizace vs. přeučení}

    \begin{center}
    \includegraphics{./img/overfitting.png} \\
    {\tiny Zdroj: https://www.geeksforgeeks.org/underfitting-and-overfitting-in-machine-learning}
    \end{center}

    \visible<2->{
        \textbf{\Large Přeučení} = model si zapamatuje trénovací data, funguje dobře jenom pro data, co vypadají jako trénovací} \\
    \visible<3->{\hfill \Large\bf \ldots nejčastější zdroj chyb a diskriminace}

\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Neuronové síťě: Jeden neuron}

    \begin{columns}
        \column{.45\textwidth}
        \input{img/single_neuron.tex}
        \column{.45\textwidth}

        \begin{itemize}[<+->]

            \item Vstupy = reálná čísla

            \item Smíchají s různými vahami

            \item Začátek v 50.\ letech, insiprace představou o neuronu
                ze 40.\ let

            \item Dnes \textbf{nic společného} s biologickými neurony

        \end{itemize}

    \end{columns}

\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Neuronová síť}

    \centering
    \includegraphics{./img/feedforward.pdf}

\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Neuronová síť}

    \begin{columns}
        \column{.4\textwidth}

        \scalebox{.75}{\input{./img/multilayer_perceptron.tex}}

        \column{.5\textwidth}
        \begin{itemize}[<+->]

            \item Organizace do vrstev $\Rightarrow$

            \begin{itemize}[<+->]

                \item Na vstup vrstvy $\sim$ vektor

                \item Vážení vstupů $\sim$ maticové násobení

                \item Výstup vrstvy $\sim$ vektor

            \end{itemize}

        \item Většina výpočtů \textbf{maticové násobení} $\Rightarrow$ rychlé počítání
            na GPU

        \item Výstup NN = \textbf{spojitá funkce} vstupů

        \end{itemize}
    \end{columns}

\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Chybová funkce \& Trénování}

    \begin{itemize}[<+->]

        \item Trénování = \textbf{minimalizace chyby} na trénovacích datech

        \item Když je chyba \textbf{spojitá funkce}, můžeme spočítat
            \textbf{derivaci chyby} vzhledem k parametrům

        \item Posunout paratetry po směru derivace = snížit chybu

    \end{itemize}

\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Problematická trénovací data}

    \visible<1->{
    {\Large\textbf{Stahování z internetu}} --- neprezentativní, extrémní názory
    jsou mnohem víc slyšet, není kontrola nad tím, co je v datech
    \\ \hfill {\footnotesize \citep{bender2021dangers}}}

    \vspace{15pt}

    \visible<2->{
    {\Large\textbf{Crowd-sourcing}} --- využívání levné pracovní síly, tzv. gig
    economy -- vznikají prekarizovaná zaměstnání
    \\ \hfill {\footnotesize \citep[kap. 2]{crawford2021atlas}}}

    \vspace{15pt}

    \visible<3->{
    {\Large\textbf{Vytěžování existujících databází}} --- neplacená práce
    uživatelů, neprůhledné využití data
    \\ \hfill {\footnotesize \citep{couldry2019costs}}}

\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Rizika učení z dat}
Učí se z dat -- co je v datech, to je v modelu; chybová funkce (typicky počet správně klasifikovaných příkladů) nemusí postihnout problémy, které model může mít - příklad analýza CV

\end{frame}

%\begin{frame}{}
%\end{frame}

% ----------------------------------------------------------------------------

\section{Strojové vidění}

\begin{frame}{Úlohy strojového vidění}

    \vspace{-5pt}
    \begin{center}
        \large Cokoli, co se dá zjistit z obrazu, např. \ldots
    \end{center}

    \visible<2->{
    \begin{columns}[t]
        \column{.3\textwidth}
        \centering \textbf{Rozpoznávání objektů} \\[1ex]
        \includegraphics[width=.98\textwidth]{img/object_detection.png} \\
        {\tiny Zdroj: \url{https://pjreddie.com/darknet/yolo}}

        \column{.3\textwidth}
        \centering \textbf{Odhad hloubky v obrazu} \\[1ex]
        \includegraphics[width=.98\textwidth]{img/monocular_depth.png} \\
        {\tiny Zdroj: \citet[s.\ 9250, obr.\ 1]{pillai2019super}}

        \column{.3\textwidth}
        \centering \textbf{Poloha lidského těla} \\[1ex]
        \includegraphics[width=.98\textwidth]{img/pose_detection.png} \\
        {\tiny Zdroj: \url{https://towardsdatascience.com/realtime-multiple-person-2d-pose-estimation-using-tensorflow2-x-93e4c156d45f}}

    \end{columns}}

    \visible<3->{\begin{center}
        \large \ldots pro člověka většinou triviální úlohy
    \end{center}}

\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Úlohy strojového vidění}

    \visible<1->{\begin{center}
        \large \ldots ale i vyžadující expertní znalost.
    \end{center}}

    \visible<2->{
    \begin{columns}[t]
        \column{.45\textwidth}
        \centering \textbf{Detekce tuberkulózy} \\[1ex]
        \includegraphics[scale=.13]{img/tuberculosis.png} \\
        {\tiny Zdroj: \citet[obr.\ 3]{Pasa-et-al-2019}}

        \column{.45\textwidth}
        \centering \textbf{Katalogizace galaxií} \\[1ex]
    \includegraphics[scale=.15]{img/galaxies.png} \\
        {\tiny Zdroj: \citep[obr.\ 4]{gonzales2018galaxy}}
    \end{columns}}

    \centering
    \visible<3->{Pro počítač žádný rozdíl.}

\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Konvoluční sítě}

    \begin{minipage}{.45\textwidth}
        \begin{itemize}[<+->]

            \item Základní nástroj pro zpracování obrazu neuronovými sítěmi

            \item Okénko, které jede přes obrázek a detekuje nějaké vzorce

            \item Mnoho vrstvev $\rightarrow$ vzorce vzorců vzorců\ldots

            \item Model si vytváří potřebné abstrakce

        \end{itemize}
    \end{minipage}\begin{minipage}{.45\textwidth}
        \centering
        \scalebox{0.7}{\input{img/convolution2d.pdf_tex}}
    \end{minipage}

\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Hluboké konvoluční sítě}

    \begin{center}
        \scalebox{0.4}{\input{./img/alexnet.pdf_tex}}
    \end{center}

    \begin{itemize}[<+->]

        \item Hluboká architektura: konvoluce, max-pooling, residual connections,
            batch normalization, 50--150 vrstev

        \item Typicky ,,předtrénováno'' na velkých datech, pro jednotlivé úlohy
            se ,,dotrénovávají'' poslední vrstvy

    \end{itemize}

%ImageNet - předtrénovaná reprezentace z ImageNetu použitelná na jakoukoli jinou úlohu (ukázat úlohy: object detection, monocular depth estimation)

\end{frame}

% ----------------------------------------------------------------------------

%\begin{frame}{ImageNet: rozpoznávání objektů}
%
%    \begin{center}
%        Dataset, který pomohl odstartovat revoluci ve strojovém učení.
%    \end{center}
%
%    \cetering
%    \includegraphics[scale=.4]{./img/imagenet.png}
%    {\tiny Zdroj: \citet[obr\. 1]{deng2009imagenet}
%
%    \visible<2->{1.2M obrázků, 1000 různých tříd}
%
%\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{ImageNet challenge}

    \centering
    \input{plots/imagenet.tex}

\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Předtrénované reprezentace}

    \begin{columns}

        \column{.45\textwidth}
        \centering

        Nejpodobnější vektory k reprezentaci z poslední vrstvy AlexNetu.

        \includegraphics[scale=0.25]{./img/alexnet_neighbors.png} \\
        {\tiny Zdroj: \citet[obr.\ 4]{krizhevsky_imagenet_2012}}

        % TODO: vyznačit sloupec a neighbors
        % TODO: zopakovat obrázek AlexNetu 


        \column{.45\textwidth}
    \begin{itemize}[<+->]

        \item Klasifikace obrázků se učí obecné rysy

        \item Prakticky všechny úlohy začínají s předtrénovaným modelem

        \item Postupně se nahrazuje unsupervised metodami

    \end{itemize}


    \end{columns}

\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Problémy ImageNetu}
Problémy imagenetu: koncepty z WordNetu, labely jako “weirdo”, rasistické koncepty…
\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Rozpoznávání obličejů}
\end{frame}

% ----------------------------------------------------------------------------

\section{Zpracování přirozeného jazyka}

% ----------------------------------------------------------------------------

\begin{frame}{Co je zpracování přirozeného jazyka}

    \begin{center}

        \Large Úlohy, pro jejichž řešení je potřeba (do nějaké míry) \\ \textbf{rozumět
        lidskému jazyku}

    \end{center}

    \begin{itemize}[<+->]

        \item základní řešení lze obvykle jednoduše naprogramovat

        \item pro zvýšení úspěšnosti jsou potřeba stále složitější pravidla

        \item od určité úrovně si neporadíme bez strojového učení

    \end{itemize}

\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Motivační příklad: psaní I a Y (1)}

    \begin{columns}[t]
        \column{.48\textwidth}
        {\large\bf Jednoduchá pravidla} \\ ~

        \vspace{10pt}

    \begin{tabular}{lc}
        \visible<2->{
        & \bf Úspěšnost \\ \midrule
        Všechna I měkká        &    76.4\% \\}
        \visible<3->{
        + tvrdé souhlásky     &    77.5\% \\}
        \visible<4->{
        + předpona \emph{vy-} &    80.0\% \\}
    \end{tabular}

        \vspace{10pt}
        Další pravidla potřebují větný rozbor

        \column{.48\textwidth}
        \visible<5->{
            {\large\bf Jednoduchá statistika} \\}
        \visible<6->{
            \ldots každé slovo nejčastější pravopis}

        \vspace{10pt}

    \visible<7->{
    \begin{tabular}{rc}
        \bf Počet přečtených vět  &  \bf Úspěšnost \\ \midrule
                          500 &    77.9\% \\
                        5 000 &    85.3\% \\
                       50 000 &    88.6\% \\
                      500 000 &    90.4\% \\
                    5 000 000 &    90.8\% \\
    \end{tabular}}

    \end{columns}

    {\tiny Zdroj: Jindřich's Blog \url{https://jlibovicky.github.io/2017/02/22/Pravopis.html}}

\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Motivační příklad: psaní I a Y (2)}

    \centering
    \includegraphics[scale=.65]{./img/cs_spelling.pdf}

    \visible<2->{
    \begin{columns}
        \column{.35\textwidth}
        \begin{tabular}{lc}
        \bf Metoda & \bf Úspěšnost \\ \midrule

        Všechna měkká        &    70.4 \% \\
        Jednoduchá pravidla  &    80.0 \% \\
        Nejčastější pravopis &    90.8 \% \\
        Neuronová síť        &    99.8 \% \\
        \end{tabular}

        \column{.45\textwidth}
        \includegraphics[scale=.5]{./img/spelling_learning_curve_cs.pdf}
    \end{columns}}

\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Vyhledávání odpovědí na otázky}

    \centering
    \includegraphics[scale=.26]{img/qa.png} \\
    {\tiny Screenhot z~dema Allen Institute for AI \url{https://demo.allennlp.org/reading-comprehension/transformer-qa}}

\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Kontrola pravopisu}

    \centering
    \includegraphics[scale=.3]{img/grammarly.png} \\
    {\tiny Zdroj: Webová reklama grammarly.com}

\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Strojový překlad}

    \centering
    \includegraphics[scale=.4]{img/lindat.png} \\
    {\tiny Zdroj: Překladač CUBBIT \url{https://lindat.mff.cuni.cz/services/translation} \citep{popel2020transforming}}

\end{frame}

\begin{frame}{Entity extraction}

    \includegraphics[scale=.4]{./img/mona_lisa.png}
    {\tiny Zdroj: \url{https://dandelion.eu/semantic-text/entity-extraction-demo}}

    \vspace{10pt}

    \visible<2->{Podúlohy:}
    \begin{enumerate}

        \item<3-> Named entity recognition: nalézt v~textu řetězce, co obsahují
            pojmenované entity

        \item<4-> Entity linking: co entity znamenají (první pád, odkaz do
            databáze/na Wikipedii)

    \end{enumerate}

\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Koncept embeddingu}

    \begin{columns}

    \column{.45\textwidth}
    \begin{itemize}[<+->]

        \item neuronové sítě potřebují spojité vstupy

        \item one-hot vektor: očíslujeme slova, 0/1 idikuje slovo \\[1em]
            \scalebox{.9}{\input{img/onehot.tex}}

        \item první vrstva = násobení matricí

    \end{itemize}
    \column{.45\textwidth}

        \visible<4->{
        \centering
        \scalebox{4}{\rotatebox{-90}{\Huge $\Rsh$}}

        \vspace{5pt}

        {\Large
        Každé \textbf{slovo} (nebo jiná jednotka) je reprezentovaná mnohodimenzionálním
        \textbf{vektorem}}}

        \vspace{15pt}

        \begin{itemize}

            \item<5-> učí se ,,mimochodem`` z dat

            \item<6-> mají zajímavé vlastnosti

        \end{itemize}

    \end{columns}

\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Ukázka z překladače}
    \hspace*{-10pt}\includegraphics{./plots/tsne.pdf}
\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Princip transformeru}

    \begin{columns}
    \column{.45\textwidth}

        \scalebox{.8}{\input{img/bipartite.tex}}

    \column{.45\textwidth}
        \begin{itemize}[<+->]

            \item Mezi klasickými vrstvami tzv. \textbf{self-attention}

            \item Každé slovo se ,,podívá'' na ostatní slova a vezme si z~něj
                relevantní informace

            \item Na začátku: vektor reprezentuje \textbf{izolované} slovo \\
                Na konci: vektor reprezentuje slovo \textbf{v~kontextu} věty

        \end{itemize}

    \end{columns}
\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Encoder-decoder: Strojový překlad}

    \begin{center}
    \includegraphics[scale=0.55]{img/encoder_decoder.pdf}
    \end{center}

    \vspace{10pt}

    \centering
    \visible<2->{
        Dekodér sbírá informace \textbf{z~předchozích slov} a \textbf{z~enkodéru}}

\end{frame}

% ----------------------------------------------------------------------------
\begin{frame}{Zkreslení z dat}
\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Předtrénované modely v NLP}

    \centering
    \begin{tikzpicture}

            \visible<3->{\draw[dashed,Gray] (0, -100pt) -- (0, 100pt);}

            \node[draw,fill=Orange!80,inner sep=15pt] (bert) {\begin{tabular}{c}BERT \\ encoder\end{tabular}};

            \visible<2->{
            \node (pre) [left=50pt of bert.west] {\large\bf 1. Pre-training};
            \node (pre2) [below=0pt of pre.south] {\small (jednou, na velkých datech, trvá dlouho)};
            \node[draw,ellipse,inner sep=1pt,fill=Gray!20] (unlabeled) [above left=30pt and 30pt of bert.north west] {\begin{tabular}{c}prostý \\ text\end{tabular}};
            \draw[->] (unlabeled.east) to[out=0,in=90] (bert.north);
            \node[draw,ellipse,inner sep=3pt,fill=Gray!20] (mlm) [below left=30pt and 30pt of bert.south west] {masked LM};
            \draw[->] (bert.south) to[out=270,in=0] (mlm.east);}

            \visible<3->{
            \node (fine) [right=50pt of bert.east] {\large\bf 2. Finetuning};
            \node (fine2) [below=0pt of fine.south] {\small (malá data, rychle)};
            \node[draw,ellipse,inner sep=1pt,fill=Dandelion] (labeled) [above right=30pt and 30pt of bert.north east] {\begin{tabular}{c}data pro \\ specifickou \\ úlohu\end{tabular}};
            \draw[->] (labeled.west) to[out=180,in=90] (bert.north);
            \node[draw,ellipse,inner sep=3pt,fill=Dandelion] (loss) [below right=30pt and 30pt of bert.south east] {\begin{tabular}{c}task-specific \\ objective\end{tabular}};
                    \draw[->] (bert.south) to[out=270,in=180] (loss.west);}


    \end{tikzpicture}
\end{frame}

\begin{frame}{Předtrénování: Masked Language Model}

    \centering
    \fbox{\large
    \colorbox{lightgray}{All}
    \colorbox{lightgray}{human}
    \colorbox{lightgray}{being}
    \colorbox{lightgray}{are}
    \colorbox{lightgray}{born}
    \only<1>{\colorbox{lightgray}{free}}%
    \only<2>{\colorbox{GreenYellow}{free}}%
    \only<3>{\colorbox{Rhodamine!30}{\texttt{MASK}}}%
    \only<4>{\colorbox{Dandelion}{hairy}}%
    \only<5->{\colorbox{GreenYellow}{free}}
    \colorbox{lightgray}{and}
    \colorbox{lightgray}{equal}
    \colorbox{lightgray}{in}
    \colorbox{lightgray}{dignity}
    \colorbox{lightgray}{and}
    \colorbox{lightgray}{rights}}

    \vspace{20pt}

    \begin{enumerate}

        \item<2-> Náhodně vybereme slovo $\rightarrow$
            \colorbox{GreenYellow}{free}

        \item<3-> S~pravděpodobností 80\% ho nahradíme značku
            \colorbox{Rhodamine!30}{\texttt{MASK}}

        \item<4-> S~pravděpodobností 10\% ho nahradíme náhodným slovem $\rightarrow$
            \colorbox{Dandelion}{hairy}

        \item<5-> S~pravděpodobností 10\% ho necháme, jak je $\rightarrow$
            \colorbox{GreenYellow}{free}

    \end{enumerate}

		\vspace{10pt}

    \visible<6->{
    Then a classifier should predict the missing/replaced word
            \colorbox{GreenYellow}{free}}

\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Pre-training -- Finetuning}

    \centering

    {\huge
    Většina state-of-the-art řešení v NLP používá předtrénovaný model
    dotrénovaný na datech specifických pro úlohu.}

    \vspace{30pt}

    S výjimkou strojového překladu ,,velkých jazyků'' platí pro všechny úlohy,
    co jsme viděli.

    \vspace{10pt}

    Trend vývoje: lepší předtrénované modely, nižší potřeba specifických dat

\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Jazykové modely GPT}

    \begin{itemize}[<+->]

        \item GPT = Generative Pre-trained Transformer

        \item Model, který předpovídá, jaké slovo v textu může následovat \\
            \it v~projektu TheAItre ho použili ke generování divadelní hry

        \item GPT-3 je natrénovaný na ?? větách

        \item Model, který je asi nejblíže populárním představám o AI

    \end{itemize}

\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Jazykové modely GPT}
\end{frame}

% ----------------------------------------------------------------------------

\begin{frame}{Férovost dat}

Ukázat sprosťárny a nekorektní kecy, které GPT vygeneruje

\end{frame}


\section{Zpětnovazebné učení}

% ----------------------------------------------------------------------------

\section{Generativní adversariální sítě}


\summary{Shrnutí}{%
    \begin{enumerate}
        \item Advantages of unsupervised methods.
    \end{enumerate}
}
% ----------------------------------------------------------------------------

%}

\references{odkazy.bib}

%\begin{frame}
%\frametitle{References}
%\renewcommand*{\bibfont}{\footnotesize}
%\printbibliography[heading=none]
%\end{frame}


\end{document}
